drop_na(Oocyst_Predict_Crypto) %>%
# filter(Oocyst_Predict_Crypto != 0) %>%
mutate(log_crypto = log(Oocyst_Predict_Crypto))
# Fit distributions
x <- Field_crypto$log_crypto
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -100.2979
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
tryDistrib(x, "weibullshifted")
speparam <- getParamBounds(model = "weibull", response = "log_crypto",
data = Field_crypto)
fitWL_crypto_intensity <- parasiteLoad::analyse(data = Field_crypto,
response = "log_crypto",
model = "weibull",
group = "Sex")
x
Field_crypto$ILWE_Crypto_Ct
################# infection intensities with cryptosporidium
#####  crpyto ct
Field_crypto <- Field %>%
drop_na(ILWE_Crypto_Ct) #%>%
# Fit distributions
x <- Field_crypto$ILWE_Crypto_Ct
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -100.2979
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
tryDistrib(x, "weibullshifted")
speparam <- getParamBounds(model = "weibull", response = "log_crypto",
data = Field_crypto)
fitWL_crypto_intensity <- parasiteLoad::analyse(data = Field_crypto,
response = "ILWE_Crypto_Ct",
model = "normal",
group = "Sex")
# plot it
plot_WL_crypto_intensity <-
bananaPlot(mod = fitWL_crypto_intensity$H3,
data = Field_crypto,
response = "ILWE_Crypto_Ct",
group = "Sex") +
theme_bw()
plot_WL_crypto_intensity
filter(ILWE_Crypto_Ct != 0)# %>%
# Fit distributions
x <- Field_crypto$ILWE_Crypto_Ct
################# infection intensities with cryptosporidium
#####  crpyto ct
Field_crypto <- Field %>%
drop_na(ILWE_Crypto_Ct) #%>%
################# infection intensities with cryptosporidium
#####  crpyto ct
Field_crypto <- Field %>%
drop_na(ILWE_Crypto_Ct) %>%
filter(ILWE_Crypto_Ct != 0)# %>%
# Fit distributions
x <- Field_crypto$ILWE_Crypto_Ct
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -100.2979
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
tryDistrib(x, "weibullshifted")
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -100.2979
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -100.2979
fitWL_crypto_intensity <- parasiteLoad::analyse(data = Field_crypto,
response = "ILWE_Crypto_Ct",
model = "normal",
group = "Sex")
# plot it
plot_WL_crypto_intensity <-
bananaPlot(mod = fitWL_crypto_intensity$H3,
data = Field_crypto,
response = "ILWE_Crypto_Ct",
group = "Sex") +
theme_bw()
plot_WL_crypto_intensity
# Eimeria intensities
Field_intensity <- Field %>%
drop_na(delta_ct_cewe_MminusE)
# Eimeria intensities
Field_intensity <- Field %>%
drop_na(delta_ct_cewe_MminusE) %>%
filter(MC.Eimeria == TRUE)
View(Field_intensity)
x <- Field_intensity$delta_ct_cewe_MminusE
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") #
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
tryDistrib(x, "weibullshifted")
plot(x)
hist(x)
# Eimeria intensities
Field_intensity <- Field %>%
drop_na(delta_ct_cewe_MminusE) %>%
filter(MC.Eimeria == TRUE, delta_ct_cewe_MminusE > -5)
x <- Field_intensity$delta_ct_cewe_MminusE
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -251.5417
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
tryDistrib(x, "weibullshifted")
hist(x)
fitintensity <- parasiteLoad::analyse(data = Field_intensity,
response = "delta_ct_cewe_MminusE",
model = "normal",
group = "Sex")
# Eimeria intensities
Field_intensity <- Field %>%
drop_na(delta_ct_cewe_MminusE) %>%
filter(#MC.Eimeria == TRUE,
delta_ct_cewe_MminusE > -5)
x <- Field_intensity$delta_ct_cewe_MminusE
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -251.5417
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
tryDistrib(x, "weibullshifted")
hist(x)
fitintensity <- parasiteLoad::analyse(data = Field_intensity,
response = "delta_ct_cewe_MminusE",
model = "normal",
group = "Sex")
# plot it
plot_intensity <-
bananaPlot(mod = fitintensity$H3,
data = Field_crypto,
response = "delta_ct_cewe_MminusE",
group = "Sex") +
theme_bw()
# Eimeria intensities
Field_intensity <- Field %>%
drop_na(delta_ct_cewe_MminusE) %>%
filter(MC.Eimeria == TRUE)
x <- Field_intensity$delta_ct_cewe_MminusE
## Now fit the distributions to the predicted weight loss data
tryDistrib(x, "normal") # -251.5417
tryDistrib(x, "binomial")
tryDistrib(x, "student")
tryDistrib(x, "weibull") # -99.39387
tryDistrib(x, "weibullshifted")
hist(x)
fitintensity <- parasiteLoad::analyse(data = Field_intensity,
response = "delta_ct_cewe_MminusE",
model = "normal",
group = "Sex")
# plot it
plot_intensity <-
bananaPlot(mod = fitintensity$H3,
data = Field_crypto,
response = "delta_ct_cewe_MminusE",
group = "Sex") +
theme_bw()
plot_intensity
#####  Aspiculuris_sp
Aspiculuris_sp <- Field %>%
mutate(crypto_infected_ct =
case_when(
Aspiculuris_sp > 0 ~ "TRUE",
Aspiculuris_sp == 0 ~ "FALSE",
Aspiculuris_sp == NA ~ NA
))
Aspiculuris_sp <- Aspiculuris_sp %>%
drop_na(Aspiculuris_sp)
#####  Aspiculuris_sp
wormy_field <- Field %>%
mutate(crypto_infected_ct =
case_when(
Aspiculuris_sp > 0 ~ "TRUE",
Aspiculuris_sp == 0 ~ "FALSE",
Aspiculuris_sp == NA ~ NA
))
wormy_field <- wormy_field %>%
drop_na(Aspiculuris_sp)
wormy_field$Aspiculuris_sp <- as.factor(wormy_field$Aspiculuris_sp)
fitWL_worm <- parasiteLoad::analyse(data = wormy_field,
response = "predicted_WL",
model = "normal",
group = "Aspiculuris_sp")
#####  Aspiculuris_sp
wormy_field <- Field %>%
mutate(crypto_infected_ct =
case_when(
Aspiculuris_sp > 0 ~ "TRUE",
Aspiculuris_sp == 0 ~ "FALSE",
Aspiculuris_sp == NA ~ NA
))
wormy_field <- wormy_field %>%
drop_na(Aspiculuris_sp)
wormy_field$Aspiculuris_sp <- as.factor(wormy_field$Aspiculuris_sp)
fitWL_worm <- parasiteLoad::analyse(data = wormy_field,
response = "predicted_WL",
model = "normal",
group = "Aspiculuris_sp")
#####  Aspiculuris_sp
wormy_field <- Field %>%
mutate(wormy_asp =
case_when(
Aspiculuris_sp > 0 ~ "TRUE",
Aspiculuris_sp == 0 ~ "FALSE",
Aspiculuris_sp == NA ~ NA
))
wormy_field$wormy_asp <- as.factor(wormy_field$wormy_asp)
fitWL_worm <- parasiteLoad::analyse(data = wormy_field,
response = "predicted_WL",
model = "normal",
group = "wormy_asp")
# plot it
plot_WL_worms <-
bananaPlot(mod = fitWL_worm$H3,
data = wormy_field,
response = "predicted_WL",
group = "wormy_asp",
cols = c("white", "white")) +
scale_fill_manual(values = c("steelblue1", "indianred3"),
name = "Detected Aspiculuris") +
scale_color_manual(values = c("steelblue1", "indianred3"),
name = "Detected Aspiculuris") +
theme_bw()  +
theme(legend.position = c(0.5, 0.05),
legend.direction = "horizontal",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
labs(y = "Predicted detrimental health impact,
Immune signature")
plot_WL_worms
# Create the combined plot with the gradient bar as the "axis"
plot_WL_worms <-
plot_grid(plot_WL_worms ,
HIgradientBar,
nrow = 2,
rel_heights = c(1.3, 1/8),
align = "hv",
axis = "tb",
vjust = c(-1,2),
scale = 1)
# Display the combined plot
plot_WL_worms
ggsave(plot = plot_WL_worms,
filename = "figures/hybrid_aspiculuris.jpeg", width = 10,
height = 8, dpi = 1000)
################################################
##############
######Worms?
Field %>%
pivot_longer(cols = c("Trichuris_muris", "Mastophorus_muris",
"Catenotaenia_pusilla", "Heligmosomoides_polygurus",
"Heterakis_sp", "Aspiculuris_sp", "Syphacia_sp",
"Taenia_sp", "Hymenolepis_sp"), names_to = "Worms",
values_to = "Counts_worms") %>%
ggplot(aes(x = Worms, y = Counts_worms)) +
geom_violin()
##############################################################
#####  Syphacia
wormy_field <- Field %>%
mutate(wormy_asp =
case_when(
Syphacia_sp > 0 ~ "TRUE",
Syphacia_sp == 0 ~ "FALSE",
Syphacia_sp == NA ~ NA
))
wormy_field <- wormy_field %>%
drop_na(wormy_asp)
wormy_field$wormy_asp <- as.factor(wormy_field$wormy_asp)
fitWL_worm <- parasiteLoad::analyse(data = wormy_field,
response = "predicted_WL",
model = "normal",
group = "wormy_asp")
# plot it
plot_WL_syphacia <-
bananaPlot(mod = fitWL_worm$H3,
data = wormy_field,
response = "predicted_WL",
group = "wormy_asp",
cols = c("white", "white")) +
scale_fill_manual(values = c("steelblue1", "indianred3"),
name = "Detected Syphacia") +
scale_color_manual(values = c("steelblue1", "indianred3"),
name = "Detected Syphacia") +
theme_bw()  +
theme(legend.position = c(0.5, 0.05),
legend.direction = "horizontal",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
labs(y = "Predicted detrimental health impact,
Immune signature")
plot_WL_syphacia
# Create the combined plot with the gradient bar as the "axis"
plot_WL_syphacia <-
plot_grid(plot_WL_syphacia ,
HIgradientBar,
nrow = 2,
rel_heights = c(1.3, 1/8),
align = "hv",
axis = "tb",
vjust = c(-1,2),
scale = 1)
# Display the combined plot
plot_WL_syphacia
ggsave(plot = plot_WL_syphacia,
filename = "figures/hybrid_syphacia.jpeg", width = 10,
height = 8, dpi = 1000)
################################################
##############
######Worms?
##################First aspiculuris
Field %>%
pivot_longer(cols = c("Trichuris_muris", "Mastophorus_muris",
"Catenotaenia_pusilla", "Heligmosomoides_polygurus",
"Heterakis_sp", "Aspiculuris_sp", "Syphacia_sp",
"Taenia_sp", "Hymenolepis_sp"), names_to = "Worms",
values_to = "Counts_worms") %>%
ggplot(aes(x = Worms, y = Counts_worms)) +
geom_violin()
#####  Trichuris
wormy_field <- Field %>%
mutate(wormy_asp =
case_when(
Trichuris_muris > 0 ~ "TRUE",
Trichuris_muris == 0 ~ "FALSE",
Trichuris_muris == NA ~ NA
))
wormy_field <- wormy_field %>%
drop_na(wormy_asp)
wormy_field$wormy_asp <- as.factor(wormy_field$wormy_asp)
fitWL_worm <- parasiteLoad::analyse(data = wormy_field,
response = "predicted_WL",
model = "normal",
group = "wormy_asp")
# plot it
plot_WL_trichuris <-
bananaPlot(mod = fitWL_worm$H3,
data = wormy_field,
response = "predicted_WL",
group = "wormy_asp",
cols = c("white", "white")) +
scale_fill_manual(values = c("steelblue1", "indianred3"),
name = "Detected Trichuris") +
scale_color_manual(values = c("steelblue1", "indianred3"),
name = "Detected Trichuris") +
theme_bw()  +
theme(legend.position = c(0.5, 0.05),
legend.direction = "horizontal",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
labs(y = "Predicted detrimental health impact,
Immune signature")
plot_WL_syphacia
plot_WL_trichuris
# Create the combined plot with the gradient bar as the "axis"
plot_WL_trichuris <-
plot_grid(plot_WL_trichuris ,
HIgradientBar,
nrow = 2,
rel_heights = c(1.3, 1/8),
align = "hv",
axis = "tb",
vjust = c(-1,2),
scale = 1)
# Display the combined plot
plot_WL_trichuris
ggsave(plot = plot_WL_trichuris,
filename = "figures/hybrid_trichuris.jpeg", width = 10,
height = 8, dpi = 1000)
?plot_grid
plot_grid(plot_WL_mc_combined, combined_plot, combined_plot_ooc, plot_WL_crypto,
plot_WL_crypto_Ct, plot_WL_worms, plot_WL_syphacia, plot_WL_trichuris,
nrow = 4, align = c("hv"))
letters
LETTERS
plot_grid(plot_WL_mc_combined, combined_plot, combined_plot_ooc, plot_WL_crypto,
plot_WL_crypto_Ct, plot_WL_worms, plot_WL_syphacia, plot_WL_trichuris,
nrow = 4, align = c("hv"), labels = LETTERS[1:8])
infection_plots <-
plot_grid(plot_WL_mc_combined, combined_plot, combined_plot_ooc, plot_WL_crypto,
plot_WL_crypto_Ct, plot_WL_worms, plot_WL_syphacia, plot_WL_trichuris,
nrow = 4, align = c("hv"), labels = LETTERS[1:8])
ggsave(plot = infection_plots, path = "figure_panels/infection_panel.jpeg" width = 8, height = 16, dpi = 1000)
ggsave(plot = infection_plots, path = "figure_panels/infection_panel.jpeg",
width = 8, height = 16, dpi = 1000)
ggsave(plot = infection_plots, path = "figure_panels/infection_panel.jpeg",
width = 8, height = 16, dpi = 1000)
ggsave(infection_plots, "figure_panels/infection_panel.jpeg",
width = 8, height = 16, dpi = 1000)
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 8, height = 16, dpi = 1000)
View(plot_WL_crypto_intensity)
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 12, height = 16, dpi = 1000)
View(plot_WL_crypto_intensity)
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 12, height = 18, dpi = 1000)
View(plot_WL_ooc)
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 12, height = 20, dpi = 1000)
View(plot_WL_ct)
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 12, height = 24, dpi = 1000)
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 12, height = 24, dpi = 1000)
infection_plots <-
plot_grid(plot_WL_mc_combined, combined_plot, combined_plot_ooc, plot_WL_crypto,
plot_WL_crypto_Ct, plot_WL_worms, plot_WL_syphacia, plot_WL_trichuris,
nrow = 4, align = c("hv"), labels = LETTERS[1:8])
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 12, height = 24, dpi = 1000)
# Display the combined plot
combined_plot_ooc
################################################
##############
######Worms?
##################First aspiculuris
Field %>%
pivot_longer(cols = c("Trichuris_muris", "Mastophorus_muris",
"Catenotaenia_pusilla", "Heligmosomoides_polygurus",
"Heterakis_sp", "Aspiculuris_sp", "Syphacia_sp",
"Taenia_sp", "Hymenolepis_sp"), names_to = "Worms",
values_to = "Counts_worms") %>%
ggplot(aes(x = Worms, y = Counts_worms)) +
geom_violin()
##############  Heterakis
wormy_field <- Field %>%
mutate(wormy_asp =
case_when(
Heterakis_sp > 0 ~ "TRUE",
Heterakis_sp == 0 ~ "FALSE",
Heterakis_sp == NA ~ NA
))
wormy_field <- wormy_field %>%
drop_na(wormy_asp)
wormy_field$wormy_asp <- as.factor(wormy_field$wormy_asp)
fitWL_worm <- parasiteLoad::analyse(data = wormy_field,
response = "predicted_WL",
model = "normal",
group = "wormy_asp")
# plot it
plot_WL_hetrakis <-
bananaPlot(mod = fitWL_worm$H3,
data = wormy_field,
response = "predicted_WL",
group = "wormy_asp",
cols = c("white", "white")) +
scale_fill_manual(values = c("steelblue1", "indianred3"),
name = "Detected Heterakis") +
scale_color_manual(values = c("steelblue1", "indianred3"),
name = "Detected Heterakis") +
theme_bw()  +
theme(legend.position = c(0.5, 0.05),
legend.direction = "horizontal",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
labs(y = "Predicted detrimental health impact,
Immune signature")
plot_WL_heterakis
plot_WL_hetrakis
# plot it
plot_WL_heterakis <-
bananaPlot(mod = fitWL_worm$H3,
data = wormy_field,
response = "predicted_WL",
group = "wormy_asp",
cols = c("white", "white")) +
scale_fill_manual(values = c("steelblue1", "indianred3"),
name = "Detected Heterakis") +
scale_color_manual(values = c("steelblue1", "indianred3"),
name = "Detected Heterakis") +
theme_bw()  +
theme(legend.position = c(0.5, 0.05),
legend.direction = "horizontal",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
labs(y = "Predicted detrimental health impact,
Immune signature")
# Create the combined plot with the gradient bar as the "axis"
plot_WL_heterakis <-
plot_grid(plot_WL_heterakis ,
HIgradientBar,
nrow = 2,
rel_heights = c(1.3, 1/8),
align = "hv",
axis = "tb",
vjust = c(-1,2),
scale = 1)
# Display the combined plot
plot_WL_heterakis
ggsave(plot = plot_WL_heterakis,
filename = "figures/hybrid_heterakis.jpeg", width = 10,
height = 8, dpi = 1000)
plot_WL_crypto
infection_plots <-
plot_grid(plot_WL_mc_combined, combined_plot, combined_plot_ooc,
plot_WL_crypto_Ct, plot_WL_worms, plot_WL_syphacia, plot_WL_trichuris,
plot_WL_heterakis,
nrow = 4, align = c("hv"), labels = LETTERS[1:8])
ggsave(infection_plots, filename = "figure_panels/infection_panel.jpeg",
width = 12, height = 24, dpi = 1000)
