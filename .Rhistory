axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
) -> lm_short
lm_short
model <- lm(predictions ~ WL_max * current_infection, data = test_lab)
summary(model)
### plotting
test_lab %>%
ggplot(aes(x = predictions, y = WL_max, color = current_infection)) +
geom_point(aes(size = delta_ct_cewe_MminusE), alpha = 0.7) +
labs(
x = "Predictions: Maximum weight loss",
y = "Observed: Maximum weight loss",
#  title = "Relationship between Predicted and Observed Weight Loss",
#subtitle = "Grouped by Current Infection and Sized by Delta CT Value",
color = "Current Infection",
size = "Delta Ct value",
shape = "Delta Ct treshold"
) +
theme_minimal() +
theme(
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title = element_text(size = 14, face = "bold"),
axis.text = element_text(size = 12),
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
plot.subtitle = element_text(size = 14, hjust = 0.5),
panel.grid.major = element_line(color = "gray90"),
panel.grid.minor = element_blank() +
annotate("text")
) +
scale_color_manual(values = c(E_falciformis = "salmon",
E_ferrisi = "forestgreen",
uninfected = "deepskyblue")) +
scale_size_continuous(range = c(2, 10)) -> predictions_random_for_lab
predictions_random_for_lab
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "darkolivegreen4") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)) +
annotate("text") -> lm_short
lm_short
test_lab   %>%
ggplot(aes(x = predictions, y = WL_max)) +
geom_smooth(method = lm, se = TRUE) +
labs(x = "Predictions: Maximum weight loss",
y = "Observed: Maximum weight loss") +
geom_point(aes(x = predictions, y = WL_max, size = 0.8, alpha = 0.3)) +
labs(x = "Predictions: Maximum weight loss",
y = "Observed: Maximum weight loss") +
theme_light() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
legend.position = "none") +
annotate("text", x = min(test_lab$predictions), y = max(test_lab$WL_max),
label = formula_text, hjust = 0, vjust = 4, size = 4, color = "blue") +
annotate("text", x = min(test_lab$predictions), y = max(test_lab$WL_max),
label = cor_text, hjust = 0, vjust = 1.5, size = 4, color = "blue") -> linear_plot
linear_plot
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "darkolivegreen4") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)) +
annotate("text", label = "hello", hjust = 0, vjust = 1.5, size = 4, color = "blue") -> lm_short
lm_short
?ggplot2
?geom_text
model <- lm(predictions ~ WL_max * current_infection, data = test_lab)
summary(model)
#### Plotting
# Then, define the color for each level of infection
color_mapping <- c("E_falciformis" = "salmon",
"E_ferrisi" = "forestgreen",
"uninfected" = "cornflowerblue")
ggpredict(model, terms = c("WL_max", "current_infection")) %>%
plot(colors = "darkorchid") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
) -> lm_weight_loss_predictions
lm_weight_loss_predictions
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "darkolivegreen4") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)) +
geom_text(hm)-> lm_short
lm_short
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "darkolivegreen4") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
model <- lm(predictions ~ WL_max, data = test_lab)
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "darkolivegreen4") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
test_lab$delta_ct_cewe_MminusE
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
model <- lm(predictions ~ WL_max * delta_ct_cewe_MminusE , data = test_lab)
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
model <- lm(predictions ~ WL_max * current_infection, data = test_lab)
summary(model)
#### Plotting
# Then, define the color for each level of infection
color_mapping <- c("E_falciformis" = "salmon",
"E_ferrisi" = "forestgreen",
"uninfected" = "cornflowerblue")
ggpredict(model, terms = c("WL_max", "current_infection")) %>%
plot(colors = "darkorchid") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)
) -> lm_weight_loss_predictions
lm_weight_loss_predictions
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE")) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
model <- lm(predictions ~ WL_max * delta_ct_cewe_MminusE , data = test_lab)
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE")) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max")) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
model <- lm(predictions ~ WL_max * delta_ct_cewe_MminusE , data = test_lab)
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot(colors = "blue") +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot()+
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot(colors = delta_ct_cewe_MminusE) +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot() +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot() +
geom_point() +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot() +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
library(ggiraphExtra)
devtools::install_github("cardiomoon/ggiraphExtra")
library(ggiraphExtra)
test_lab   %>%
ggplot(aes(x = predictions, y = WL_max)) +
geom_smooth(method = lm, se = TRUE) +
labs(x = "Predictions: Maximum weight loss",
y = "Observed: Maximum weight loss") +
geom_point(aes(x = predictions, y = WL_max, size = 0.8, alpha = 0.3)) +
labs(x = "Predictions: Maximum weight loss",
y = "Observed: Maximum weight loss") +
theme_light() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
legend.position = "none") +
annotate("text", x = min(test_lab$predictions), y = max(test_lab$WL_max),
label = formula_text, hjust = 0, vjust = 4, size = 4, color = "blue") +
annotate("text", x = min(test_lab$predictions), y = max(test_lab$WL_max),
label = cor_text, hjust = 0, vjust = 1.5, size = 4, color = "blue") -> linear_plot
linear_plot
ggpredict(model, terms = c("WL_max", "delta_ct_cewe_MminusE"), interactive=TRUE) %>%
plot() +
labs(title = NULL) +  # This removes the title
# ggtitle("Effect of PC2 on Predicted Weight Loss") +
xlab("Observed maximum weight loss during infections") +
ylab("Predicted maximum weight loss during infections") +
theme_minimal() +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
theme(
plot.title = element_text(size = 16, hjust = 0.5),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 12))-> lm_short
lm_short
